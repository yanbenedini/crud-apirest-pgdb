openapi: 3.0.0
info:
  title: API de Controle de Estoque
  version: 1.0.0
  description: Documentação da API utilizando Swagger

servers:
  - url: http://localhost:3000

paths:
  # --------------------------
  # USUÁRIOS
  # --------------------------
  /api/usuarios/cadastro:
    post:
      summary: Criar um novo usuário
      tags: [Usuarios]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [nome, email, senha]
              properties:
                nome:
                  type: string
                  example: "João Silva"
                email:
                  type: string
                  format: email
                  example: "joao@email.com"
                senha:
                  type: string
                  format: password
                  example: "123456"
      responses:
        201:
          description: Usuário criado com sucesso
        400:
          description: Erro ao criar usuário (dados inválidos ou email duplicado)

  /api/usuarios/login:
    post:
      summary: Realizar login
      tags: [Usuarios]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, senha]
              properties:
                email:
                  type: string
                  format: email
                  example: "joao@email.com"
                senha:
                  type: string
                  format: password
                  example: "123456"
      responses:
        200:
          description: Login realizado com sucesso (retorna token JWT)
        401:
          description: Credenciais inválidas

  /api/usuarios:
    get:
      summary: Listar usuários
      tags: [Usuarios]
      security:
        - BearerAuth: []
      responses:
        200:
          description: Lista de usuários

  /api/usuarios/{id}:
    get:
      summary: Buscar usuário por ID
      tags: [Usuarios]
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        200:
          description: Dados do usuário
        404:
          description: Usuário não encontrado
    put:
      summary: Atualizar usuário
      tags: [Usuarios]
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                nome:
                  type: string
                email:
                  type: string
                senha:
                  type: string
      responses:
        200:
          description: Usuário atualizado
        404:
          description: Usuário não encontrado
    delete:
      summary: Deletar usuário
      tags: [Usuarios]
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        200:
          description: Usuário removido
        404:
          description: Usuário não encontrado

  # --------------------------
  # FORNECEDORES
  # --------------------------
  /api/fornecedores:
    post:
      summary: Criar fornecedor
      tags: [Fornecedores]
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [nome, cnpj]
              properties:
                nome:
                  type: string
                  example: "Distribuidora XYZ"
                cnpj:
                  type: string
                  example: "00.000.000/0001-99"
                email:
                  type: string
                  example: "contato@xyz.com"
                telefone:
                  type: string
                  example: "(11) 99999-9999"
                endereco:
                  type: string
                  example: "Rua Industrial, 100"
      responses:
        201:
          description: Fornecedor criado
        400:
          description: Erro de validação (CNPJ já existe ou campos faltando)

    get:
      summary: Listar fornecedores
      tags: [Fornecedores]
      security:
        - BearerAuth: []
      responses:
        200:
          description: Lista de fornecedores

  /api/fornecedores/{id}:
    get:
      summary: Buscar fornecedor por ID
      tags: [Fornecedores]
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      responses:
        200:
          description: Dados do fornecedor
        404:
          description: Fornecedor não encontrado

    put:
      summary: Atualizar fornecedor
      tags: [Fornecedores]
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                nome:
                  type: string
                cnpj:
                  type: string
                email:
                  type: string
                telefone:
                  type: string
                endereco:
                  type: string
      responses:
        200:
          description: Fornecedor atualizado
        404:
          description: Fornecedor não encontrado

    delete:
      summary: Remover fornecedor
      tags: [Fornecedores]
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      responses:
        200:
          description: Fornecedor removido
        404:
          description: Fornecedor não encontrado

  # --------------------------
  # PRODUTOS
  # --------------------------
  /api/produtos:
    post:
      summary: Criar produto
      tags: [Produtos]
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [nome, preco, quantidade, categoria, fornecedor_id]
              properties:
                nome:
                  type: string
                  example: "Teclado Mecânico"
                descricao:
                  type: string
                  example: "Switch Blue, RGB"
                preco:
                  type: number
                  format: float
                  example: 150.50
                quantidade:
                  type: integer
                  example: 50
                categoria:
                  type: string
                  example: "Periféricos"
                fornecedor_id:
                  type: integer
                  example: 1
      responses:
        201:
          description: Produto criado
        400:
          description: Campos obrigatórios faltando ou inválidos

    get:
      summary: Listar produtos
      tags: [Produtos]
      security:
        - BearerAuth: []
      parameters:
        - in: query
          name: categoria
          schema:
            type: string
          description: Filtrar produtos por categoria
      responses:
        200:
          description: Lista de produtos

  /api/produtos/{id}:
    get:
      summary: Buscar produto por ID
      tags: [Produtos]
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      responses:
        200:
          description: Dados do produto
        404:
          description: Produto não encontrado

    put:
      summary: Atualizar produto
      tags: [Produtos]
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                nome:
                  type: string
                descricao:
                  type: string
                preco:
                  type: number
                quantidade:
                  type: integer
                categoria:
                  type: string
                fornecedor_id:
                  type: integer
      responses:
        200:
          description: Produto atualizado
        404:
          description: Produto não encontrado

    delete:
      summary: Remover produto
      tags: [Produtos]
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      responses:
        200:
          description: Produto removido
        404:
          description: Produto não encontrado

  /api/produtos/{id}/quantidade:
    patch:
      summary: Atualizar estoque (Adicionar, Remover ou Definir)
      tags: [Produtos]
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [quantidade]
              properties:
                quantidade:
                  type: integer
                  description: Valor a ser alterado ou definido
                  example: 10
                operacao:
                  type: string
                  enum: [adicionar, remover]
                  description: "Se não enviado, define o valor absoluto. Opções: 'adicionar' ou 'remover'."
                  example: "adicionar"
      responses:
        200:
          description: Quantidade atualizada com sucesso
        400:
          description: Erro (quantidade negativa ou estoque insuficiente)
        404:
          description: Produto não encontrado

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
